diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..c5e0fb1
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1,17 @@
+# local / generated
+node_modules/
+*.tar.gz
+*.tgz
+*.log
+
+# image gallery
+image_gallery/images/
+image_gallery/node_modules/
+image_gallery/.thumbs/
+image_gallery/node-standalone.log
+image_gallery/node-standalone.pid
+image_gallery_code.tar.gz
+zz-image-gallery_*.tar.gz
+
+# misc
+.DS_Store
diff --git a/image_gallery/CHANGELOG.md b/image_gallery/CHANGELOG.md
new file mode 100644
index 0000000..dd8c267
--- /dev/null
+++ b/image_gallery/CHANGELOG.md
@@ -0,0 +1,44 @@
+# Changelog (Image Gallery)
+
+This is a lightweight running log of notable changes while iterating.
+Times are approximate; focus is on what changed.
+
+## 2026-01-30
+
+### UX / Playback
+- Autoplay button now loads file list if needed, then opens the first image and starts autoplay.
+- Close (✕) button remains visible in immersive/autoplay mode.
+- Autoplay pause/resume behavior fixed:
+  - Play button icon follows `autoplayEnabled` (intent), not whether a timer exists.
+  - If autoplay is temporarily paused by touch/gesture, clicking play resumes rather than toggling off.
+- Keyboard support: **Space** toggles autoplay while lightbox is open (prevents page scroll).
+
+### Layout / Grid
+- Default columns behavior:
+  - Desktop first-open defaults to **auto layout**;
+  - Mobile first-open defaults to **3 columns**;
+  - Added settings option: **auto**.
+- Vertical gaps tightened; aligned vertical/horizontal spacing.
+- Removed/disabled “wide full-row tiles” to avoid single-image rows.
+- Desktop auto layout updated to fixed column counts (uniform width) with breakpoints.
+- Added more height variety via aspect-ratio classes (width stays consistent).
+
+### Styling
+- Introduced iOS-like continuous corner radius variables: `--r-sm`, `--r-md`, `--r-lg`.
+- Applied unified corner radius to tiles, lightbox, thumbnails, action bar, buttons, inputs.
+
+### Delete / Selection
+- Added **Delete Mode** entry in Settings (and exit toggle).
+- Action bar shows whenever selection mode is active (not only after selecting items).
+- Kept multiple entry paths: desktop right-click / mobile long-press / settings button.
+
+### Visual variety
+- Added circular + ellipse tiles as deliberate accents, with logic to avoid clustering at the beginning/end and avoid consecutive decorated tiles.
+- Added **Bubble layout (experimental)** toggle in Settings using Matter.js physics packing.
+
+### Ops / Running mode
+- Switched from Docker to **standalone node** for rapid iteration:
+  - Log: `image_gallery/node-standalone.log`
+  - PID: `image_gallery/node-standalone.pid`
+  - Images directory: `image_gallery/images/`
+- Noted issue where an old node process could keep port 8088; now need to ensure the actual listener is replaced.
diff --git a/image_gallery/Dockerfile b/image_gallery/Dockerfile
new file mode 100644
index 0000000..61deb0a
--- /dev/null
+++ b/image_gallery/Dockerfile
@@ -0,0 +1,8 @@
+FROM node:22-slim
+WORKDIR /app
+COPY package.json package-lock.json* ./
+RUN npm install --omit=dev
+COPY server.js ./
+ENV PORT=3000
+EXPOSE 3000
+CMD ["npm","start"]
diff --git a/image_gallery/README.md b/image_gallery/README.md
new file mode 100644
index 0000000..949c69f
--- /dev/null
+++ b/image_gallery/README.md
@@ -0,0 +1,30 @@
+# Image Gallery (local images → web)
+
+把宿主机某个目录里的图片，以网页画廊方式展示。
+
+## 1) 准备图片目录
+默认会读取项目内 `./images`。你也可以指定宿主机目录：
+
+```bash
+export IMAGE_DIR_HOST=/root/your/images
+```
+
+支持 jpg/jpeg/png/gif/webp/bmp/svg。
+
+## 2) 启动
+```bash
+cd /root/clawd/image_gallery
+# 可选：对外端口
+export PORT=8088
+
+docker compose up -d --build
+```
+
+访问：
+- 本机：`http://127.0.0.1:8088`
+- 远程：`http://<你的VPS公网IP>:8088`
+
+## 3) 关闭
+```bash
+docker compose down
+```
diff --git a/image_gallery/compose.yaml b/image_gallery/compose.yaml
new file mode 100644
index 0000000..9ba7905
--- /dev/null
+++ b/image_gallery/compose.yaml
@@ -0,0 +1,15 @@
+services:
+  gallery:
+    build: .
+    container_name: image-gallery
+    ports:
+      - "${PORT:-8088}:3000"
+    environment:
+      - PORT=3000
+      - IMAGES_DIR=/images
+      # 上传口令（建议设置一个复杂点的）
+      - UPLOAD_TOKEN=${UPLOAD_TOKEN:-}
+    volumes:
+      # 把宿主机图片目录挂载到容器 /images（需要写入所以不能 ro）
+      - "${IMAGE_DIR_HOST:-./images}:/images"
+    restart: unless-stopped
diff --git a/image_gallery/package-lock.json b/image_gallery/package-lock.json
new file mode 100644
index 0000000..c000290
--- /dev/null
+++ b/image_gallery/package-lock.json
@@ -0,0 +1,1493 @@
+{
+  "name": "image-gallery",
+  "version": "1.0.0",
+  "lockfileVersion": 3,
+  "requires": true,
+  "packages": {
+    "": {
+      "name": "image-gallery",
+      "version": "1.0.0",
+      "dependencies": {
+        "express": "^4.19.2",
+        "multer": "^1.4.5-lts.1",
+        "sharp": "^0.33.5"
+      }
+    },
+    "node_modules/@emnapi/runtime": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.8.1.tgz",
+      "integrity": "sha512-mehfKSMWjjNol8659Z8KxEMrdSJDDot5SXMq00dM8BN4o+CLNXQ0xH2V7EchNHV4RmbZLmmPdEaXZc5H2FXmDg==",
+      "license": "MIT",
+      "optional": true,
+      "dependencies": {
+        "tslib": "^2.4.0"
+      }
+    },
+    "node_modules/@img/sharp-darwin-arm64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-arm64/-/sharp-darwin-arm64-0.33.5.tgz",
+      "integrity": "sha512-UT4p+iz/2H4twwAoLCqfA9UH5pI6DggwKEGuaPy7nCVQ8ZsiY5PIcrRvD1DzuY3qYL07NtIQcWnBSY/heikIFQ==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-darwin-arm64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-darwin-x64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-x64/-/sharp-darwin-x64-0.33.5.tgz",
+      "integrity": "sha512-fyHac4jIc1ANYGRDxtiqelIbdWkIuQaI84Mv45KvGRRxSAa7o7d1ZKAOBaYbnepLC1WqxfpimdeWfvqqSGwR2Q==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-darwin-x64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-libvips-darwin-arm64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-arm64/-/sharp-libvips-darwin-arm64-1.0.4.tgz",
+      "integrity": "sha512-XblONe153h0O2zuFfTAbQYAX2JhYmDHeWikp1LM9Hul9gVPjFY427k6dFEcOL72O01QxQsWi761svJ/ev9xEDg==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-darwin-x64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-x64/-/sharp-libvips-darwin-x64-1.0.4.tgz",
+      "integrity": "sha512-xnGR8YuZYfJGmWPvmlunFaWJsb9T/AO2ykoP3Fz/0X5XV2aoYBPkX6xqCQvUTKKiLddarLaxpzNe+b1hjeWHAQ==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linux-arm": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm/-/sharp-libvips-linux-arm-1.0.5.tgz",
+      "integrity": "sha512-gvcC4ACAOPRNATg/ov8/MnbxFDJqf/pDePbBnuBDcjsI8PssmjoKMAz4LtLaVi+OnSb5FK/yIOamqDwGmXW32g==",
+      "cpu": [
+        "arm"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linux-arm64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm64/-/sharp-libvips-linux-arm64-1.0.4.tgz",
+      "integrity": "sha512-9B+taZ8DlyyqzZQnoeIvDVR/2F4EbMepXMc/NdVbkzsJbzkUjhXv/70GQJ7tdLA4YJgNP25zukcxpX2/SueNrA==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linux-s390x": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-s390x/-/sharp-libvips-linux-s390x-1.0.4.tgz",
+      "integrity": "sha512-u7Wz6ntiSSgGSGcjZ55im6uvTrOxSIS8/dgoVMoiGE9I6JAfU50yH5BoDlYA1tcuGS7g/QNtetJnxA6QEsCVTA==",
+      "cpu": [
+        "s390x"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linux-x64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-x64/-/sharp-libvips-linux-x64-1.0.4.tgz",
+      "integrity": "sha512-MmWmQ3iPFZr0Iev+BAgVMb3ZyC4KeFc3jFxnNbEPas60e1cIfevbtuyf9nDGIzOaW9PdnDciJm+wFFaTlj5xYw==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linuxmusl-arm64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-arm64/-/sharp-libvips-linuxmusl-arm64-1.0.4.tgz",
+      "integrity": "sha512-9Ti+BbTYDcsbp4wfYib8Ctm1ilkugkA/uscUn6UXK1ldpC1JjiXbLfFZtRlBhjPZ5o1NCLiDbg8fhUPKStHoTA==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-libvips-linuxmusl-x64": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-x64/-/sharp-libvips-linuxmusl-x64-1.0.4.tgz",
+      "integrity": "sha512-viYN1KX9m+/hGkJtvYYp+CCLgnJXwiQB39damAO7WMdKWlIhmYTfHjwSbQeUK/20vY154mwezd9HflVFM1wVSw==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-linux-arm": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm/-/sharp-linux-arm-0.33.5.tgz",
+      "integrity": "sha512-JTS1eldqZbJxjvKaAkxhZmBqPRGmxgu+qFKSInv8moZ2AmT5Yib3EQ1c6gp493HvrvV8QgdOXdyaIBrhvFhBMQ==",
+      "cpu": [
+        "arm"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linux-arm": "1.0.5"
+      }
+    },
+    "node_modules/@img/sharp-linux-arm64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm64/-/sharp-linux-arm64-0.33.5.tgz",
+      "integrity": "sha512-JMVv+AMRyGOHtO1RFBiJy/MBsgz0x4AWrT6QoEVVTyh1E39TrCUpTRI7mx9VksGX4awWASxqCYLCV4wBZHAYxA==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linux-arm64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-linux-s390x": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linux-s390x/-/sharp-linux-s390x-0.33.5.tgz",
+      "integrity": "sha512-y/5PCd+mP4CA/sPDKl2961b+C9d+vPAveS33s6Z3zfASk2j5upL6fXVPZi7ztePZ5CuH+1kW8JtvxgbuXHRa4Q==",
+      "cpu": [
+        "s390x"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linux-s390x": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-linux-x64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linux-x64/-/sharp-linux-x64-0.33.5.tgz",
+      "integrity": "sha512-opC+Ok5pRNAzuvq1AG0ar+1owsu842/Ab+4qvU879ippJBHvyY5n2mxF1izXqkPYlGuP/M556uh53jRLJmzTWA==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linux-x64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-linuxmusl-arm64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-arm64/-/sharp-linuxmusl-arm64-0.33.5.tgz",
+      "integrity": "sha512-XrHMZwGQGvJg2V/oRSUfSAfjfPxO+4DkiRh6p2AFjLQztWUuY/o8Mq0eMQVIY7HJ1CDQUJlxGGZRw1a5bqmd1g==",
+      "cpu": [
+        "arm64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-linuxmusl-x64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-x64/-/sharp-linuxmusl-x64-0.33.5.tgz",
+      "integrity": "sha512-WT+d/cgqKkkKySYmqoZ8y3pxx7lx9vVejxW/W4DOFMYVSkErR+w7mf2u8m/y4+xHe7yY9DAXQMWQhpnMuFfScw==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "Apache-2.0",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-libvips-linuxmusl-x64": "1.0.4"
+      }
+    },
+    "node_modules/@img/sharp-wasm32": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-wasm32/-/sharp-wasm32-0.33.5.tgz",
+      "integrity": "sha512-ykUW4LVGaMcU9lu9thv85CbRMAwfeadCJHRsg2GmeRa/cJxsVY9Rbd57JcMxBkKHag5U/x7TSBpScF4U8ElVzg==",
+      "cpu": [
+        "wasm32"
+      ],
+      "license": "Apache-2.0 AND LGPL-3.0-or-later AND MIT",
+      "optional": true,
+      "dependencies": {
+        "@emnapi/runtime": "^1.2.0"
+      },
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-win32-ia32": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-win32-ia32/-/sharp-win32-ia32-0.33.5.tgz",
+      "integrity": "sha512-T36PblLaTwuVJ/zw/LaH0PdZkRz5rd3SmMHX8GSmR7vtNSP5Z6bQkExdSK7xGWyxLw4sUknBuugTelgw2faBbQ==",
+      "cpu": [
+        "ia32"
+      ],
+      "license": "Apache-2.0 AND LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "win32"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/@img/sharp-win32-x64": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.33.5.tgz",
+      "integrity": "sha512-MpY/o8/8kj+EcnxwvrP4aTJSWw/aZ7JIGR4aBeZkZw5B7/Jn+tY9/VNwtcoGmdT7GfggGIU4kygOMSbYnOrAbg==",
+      "cpu": [
+        "x64"
+      ],
+      "license": "Apache-2.0 AND LGPL-3.0-or-later",
+      "optional": true,
+      "os": [
+        "win32"
+      ],
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      }
+    },
+    "node_modules/accepts": {
+      "version": "1.3.8",
+      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
+      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-types": "~2.1.34",
+        "negotiator": "0.6.3"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/append-field": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/append-field/-/append-field-1.0.0.tgz",
+      "integrity": "sha512-klpgFSWLW1ZEs8svjfb7g4qWY0YS5imI82dTg+QahUvJ8YqAY0P10Uk8tTyh9ZGuYEZEMaeJYCF5BFuX552hsw==",
+      "license": "MIT"
+    },
+    "node_modules/array-flatten": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
+      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
+      "license": "MIT"
+    },
+    "node_modules/body-parser": {
+      "version": "1.20.4",
+      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.4.tgz",
+      "integrity": "sha512-ZTgYYLMOXY9qKU/57FAo8F+HA2dGX7bqGc71txDRC1rS4frdFI5R7NhluHxH6M0YItAP0sHB4uqAOcYKxO6uGA==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "~3.1.2",
+        "content-type": "~1.0.5",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "destroy": "~1.2.0",
+        "http-errors": "~2.0.1",
+        "iconv-lite": "~0.4.24",
+        "on-finished": "~2.4.1",
+        "qs": "~6.14.0",
+        "raw-body": "~2.5.3",
+        "type-is": "~1.6.18",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/buffer-from": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
+      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
+      "license": "MIT"
+    },
+    "node_modules/busboy": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
+      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
+      "dependencies": {
+        "streamsearch": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=10.16.0"
+      }
+    },
+    "node_modules/bytes": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
+      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/call-bind-apply-helpers": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
+      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/call-bound": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
+      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "get-intrinsic": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/color": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/color/-/color-4.2.3.tgz",
+      "integrity": "sha512-1rXeuUUiGGrykh+CeBdu5Ie7OJwinCgQY0bc7GCRxy5xVHy+moaqkpL/jqQq0MtQOeYcrqEz4abc5f0KtU7W4A==",
+      "license": "MIT",
+      "dependencies": {
+        "color-convert": "^2.0.1",
+        "color-string": "^1.9.0"
+      },
+      "engines": {
+        "node": ">=12.5.0"
+      }
+    },
+    "node_modules/color-convert": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
+      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "~1.1.4"
+      },
+      "engines": {
+        "node": ">=7.0.0"
+      }
+    },
+    "node_modules/color-name": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
+      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
+      "license": "MIT"
+    },
+    "node_modules/color-string": {
+      "version": "1.9.1",
+      "resolved": "https://registry.npmjs.org/color-string/-/color-string-1.9.1.tgz",
+      "integrity": "sha512-shrVawQFojnZv6xM40anx4CkoDP+fZsw/ZerEMsW/pyzsRbElpsL/DBVW7q3ExxwusdNXI3lXpuhEZkzs8p5Eg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "^1.0.0",
+        "simple-swizzle": "^0.2.2"
+      }
+    },
+    "node_modules/concat-stream": {
+      "version": "1.6.2",
+      "resolved": "https://registry.npmjs.org/concat-stream/-/concat-stream-1.6.2.tgz",
+      "integrity": "sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==",
+      "engines": [
+        "node >= 0.8"
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "buffer-from": "^1.0.0",
+        "inherits": "^2.0.3",
+        "readable-stream": "^2.2.2",
+        "typedarray": "^0.0.6"
+      }
+    },
+    "node_modules/content-disposition": {
+      "version": "0.5.4",
+      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
+      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "5.2.1"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/content-type": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
+      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/cookie": {
+      "version": "0.7.2",
+      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
+      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/cookie-signature": {
+      "version": "1.0.7",
+      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.7.tgz",
+      "integrity": "sha512-NXdYc3dLr47pBkpUCHtKSwIOQXLVn8dZEuywboCOJY/osA0wFSLlSawr3KN8qXJEyX66FcONTH8EIlVuK0yyFA==",
+      "license": "MIT"
+    },
+    "node_modules/core-util-is": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/core-util-is/-/core-util-is-1.0.3.tgz",
+      "integrity": "sha512-ZQBvi1DcpJ4GDqanjucZ2Hj3wEO5pZDS89BWbkcrvdxksJorwUDDZamX9ldFkp9aw2lmBDLgkObEA4DWNJ9FYQ==",
+      "license": "MIT"
+    },
+    "node_modules/debug": {
+      "version": "2.6.9",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
+      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "2.0.0"
+      }
+    },
+    "node_modules/depd": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
+      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/destroy": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
+      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/detect-libc": {
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz",
+      "integrity": "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==",
+      "license": "Apache-2.0",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/dunder-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
+      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "gopd": "^1.2.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/ee-first": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
+      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
+      "license": "MIT"
+    },
+    "node_modules/encodeurl": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
+      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/es-define-property": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
+      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-errors": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
+      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-object-atoms": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
+      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/escape-html": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
+      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
+      "license": "MIT"
+    },
+    "node_modules/etag": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
+      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/express": {
+      "version": "4.22.1",
+      "resolved": "https://registry.npmjs.org/express/-/express-4.22.1.tgz",
+      "integrity": "sha512-F2X8g9P1X7uCPZMA3MVf9wcTqlyNp7IhH5qPCI0izhaOIYXaW9L535tGA3qmjRzpH+bZczqq7hVKxTR4NWnu+g==",
+      "license": "MIT",
+      "dependencies": {
+        "accepts": "~1.3.8",
+        "array-flatten": "1.1.1",
+        "body-parser": "~1.20.3",
+        "content-disposition": "~0.5.4",
+        "content-type": "~1.0.4",
+        "cookie": "~0.7.1",
+        "cookie-signature": "~1.0.6",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "etag": "~1.8.1",
+        "finalhandler": "~1.3.1",
+        "fresh": "~0.5.2",
+        "http-errors": "~2.0.0",
+        "merge-descriptors": "1.0.3",
+        "methods": "~1.1.2",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "path-to-regexp": "~0.1.12",
+        "proxy-addr": "~2.0.7",
+        "qs": "~6.14.0",
+        "range-parser": "~1.2.1",
+        "safe-buffer": "5.2.1",
+        "send": "~0.19.0",
+        "serve-static": "~1.16.2",
+        "setprototypeof": "1.2.0",
+        "statuses": "~2.0.1",
+        "type-is": "~1.6.18",
+        "utils-merge": "1.0.1",
+        "vary": "~1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.10.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/finalhandler": {
+      "version": "1.3.2",
+      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.2.tgz",
+      "integrity": "sha512-aA4RyPcd3badbdABGDuTXCMTtOneUCAYH/gxoYRTZlIJdF0YPWuGqiAsIrhNnnqdXGswYk6dGujem4w80UJFhg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "2.6.9",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "statuses": "~2.0.2",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/forwarded": {
+      "version": "0.2.0",
+      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
+      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/fresh": {
+      "version": "0.5.2",
+      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
+      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/function-bind": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
+      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-intrinsic": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
+      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "es-define-property": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "es-object-atoms": "^1.1.1",
+        "function-bind": "^1.1.2",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "has-symbols": "^1.1.0",
+        "hasown": "^2.0.2",
+        "math-intrinsics": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
+      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
+      "license": "MIT",
+      "dependencies": {
+        "dunder-proto": "^1.0.1",
+        "es-object-atoms": "^1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/gopd": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
+      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-symbols": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
+      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/hasown": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
+      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/http-errors": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.1.tgz",
+      "integrity": "sha512-4FbRdAX+bSdmo4AUFuS0WNiPz8NgFt+r8ThgNWmlrjQjt1Q7ZR9+zTlce2859x4KSXrwIsaeTqDoKQmtP8pLmQ==",
+      "license": "MIT",
+      "dependencies": {
+        "depd": "~2.0.0",
+        "inherits": "~2.0.4",
+        "setprototypeof": "~1.2.0",
+        "statuses": "~2.0.2",
+        "toidentifier": "~1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/iconv-lite": {
+      "version": "0.4.24",
+      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
+      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
+      "license": "MIT",
+      "dependencies": {
+        "safer-buffer": ">= 2.1.2 < 3"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/inherits": {
+      "version": "2.0.4",
+      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
+      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
+      "license": "ISC"
+    },
+    "node_modules/ipaddr.js": {
+      "version": "1.9.1",
+      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
+      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/is-arrayish": {
+      "version": "0.3.4",
+      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.3.4.tgz",
+      "integrity": "sha512-m6UrgzFVUYawGBh1dUsWR5M2Clqic9RVXC/9f8ceNlv2IcO9j9J/z8UoCLPqtsPBFNzEpfR3xftohbfqDx8EQA==",
+      "license": "MIT"
+    },
+    "node_modules/isarray": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/isarray/-/isarray-1.0.0.tgz",
+      "integrity": "sha512-VLghIWNM6ELQzo7zwmcg0NmTVyWKYjvIeM83yjp0wRDTmUnrM678fQbcKBo6n2CJEF0szoG//ytg+TKla89ALQ==",
+      "license": "MIT"
+    },
+    "node_modules/math-intrinsics": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
+      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/media-typer": {
+      "version": "0.3.0",
+      "resolved": "https://registry.npmjs.org/media-typer/-/media-typer-0.3.0.tgz",
+      "integrity": "sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/merge-descriptors": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/merge-descriptors/-/merge-descriptors-1.0.3.tgz",
+      "integrity": "sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/methods": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
+      "integrity": "sha512-iclAHeNqNm68zFtnZ0e+1L2yUIdvzNoauKU4WBA3VvH/vPFieF7qfRlwUZU+DA9P9bPXIS90ulxoUoCH23sV2w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/mime": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/mime/-/mime-1.6.0.tgz",
+      "integrity": "sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==",
+      "license": "MIT",
+      "bin": {
+        "mime": "cli.js"
+      },
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/mime-db": {
+      "version": "1.52.0",
+      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
+      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/mime-types": {
+      "version": "2.1.35",
+      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
+      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-db": "1.52.0"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/minimist": {
+      "version": "1.2.8",
+      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
+      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/mkdirp": {
+      "version": "0.5.6",
+      "resolved": "https://registry.npmjs.org/mkdirp/-/mkdirp-0.5.6.tgz",
+      "integrity": "sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==",
+      "license": "MIT",
+      "dependencies": {
+        "minimist": "^1.2.6"
+      },
+      "bin": {
+        "mkdirp": "bin/cmd.js"
+      }
+    },
+    "node_modules/ms": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
+      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
+      "license": "MIT"
+    },
+    "node_modules/multer": {
+      "version": "1.4.5-lts.2",
+      "resolved": "https://registry.npmjs.org/multer/-/multer-1.4.5-lts.2.tgz",
+      "integrity": "sha512-VzGiVigcG9zUAoCNU+xShztrlr1auZOlurXynNvO9GiWD1/mTBbUljOKY+qMeazBqXgRnjzeEgJI/wyjJUHg9A==",
+      "deprecated": "Multer 1.x is impacted by a number of vulnerabilities, which have been patched in 2.x. You should upgrade to the latest 2.x version.",
+      "license": "MIT",
+      "dependencies": {
+        "append-field": "^1.0.0",
+        "busboy": "^1.0.0",
+        "concat-stream": "^1.5.2",
+        "mkdirp": "^0.5.4",
+        "object-assign": "^4.1.1",
+        "type-is": "^1.6.4",
+        "xtend": "^4.0.0"
+      },
+      "engines": {
+        "node": ">= 6.0.0"
+      }
+    },
+    "node_modules/negotiator": {
+      "version": "0.6.3",
+      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
+      "integrity": "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/object-assign": {
+      "version": "4.1.1",
+      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
+      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/object-inspect": {
+      "version": "1.13.4",
+      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
+      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/on-finished": {
+      "version": "2.4.1",
+      "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.4.1.tgz",
+      "integrity": "sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg==",
+      "license": "MIT",
+      "dependencies": {
+        "ee-first": "1.1.1"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/parseurl": {
+      "version": "1.3.3",
+      "resolved": "https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz",
+      "integrity": "sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/path-to-regexp": {
+      "version": "0.1.12",
+      "resolved": "https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.12.tgz",
+      "integrity": "sha512-RA1GjUVMnvYFxuqovrEqZoxxW5NUZqbwKtYz/Tt7nXerk0LbLblQmrsgdeOxV5SFHf0UDggjS/bSeOZwt1pmEQ==",
+      "license": "MIT"
+    },
+    "node_modules/process-nextick-args": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/process-nextick-args/-/process-nextick-args-2.0.1.tgz",
+      "integrity": "sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==",
+      "license": "MIT"
+    },
+    "node_modules/proxy-addr": {
+      "version": "2.0.7",
+      "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
+      "integrity": "sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg==",
+      "license": "MIT",
+      "dependencies": {
+        "forwarded": "0.2.0",
+        "ipaddr.js": "1.9.1"
+      },
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/qs": {
+      "version": "6.14.1",
+      "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.1.tgz",
+      "integrity": "sha512-4EK3+xJl8Ts67nLYNwqw/dsFVnCf+qR7RgXSK9jEEm9unao3njwMDdmsdvoKBKHzxd7tCYz5e5M+SnMjdtXGQQ==",
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "side-channel": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=0.6"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/range-parser": {
+      "version": "1.2.1",
+      "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
+      "integrity": "sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/raw-body": {
+      "version": "2.5.3",
+      "resolved": "https://registry.npmjs.org/raw-body/-/raw-body-2.5.3.tgz",
+      "integrity": "sha512-s4VSOf6yN0rvbRZGxs8Om5CWj6seneMwK3oDb4lWDH0UPhWcxwOWw5+qk24bxq87szX1ydrwylIOp2uG1ojUpA==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "~3.1.2",
+        "http-errors": "~2.0.1",
+        "iconv-lite": "~0.4.24",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/readable-stream": {
+      "version": "2.3.8",
+      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-2.3.8.tgz",
+      "integrity": "sha512-8p0AUk4XODgIewSi0l8Epjs+EVnWiK7NoDIEGU0HhE7+ZyY8D1IMY7odu5lRrFXGg71L15KG8QrPmum45RTtdA==",
+      "license": "MIT",
+      "dependencies": {
+        "core-util-is": "~1.0.0",
+        "inherits": "~2.0.3",
+        "isarray": "~1.0.0",
+        "process-nextick-args": "~2.0.0",
+        "safe-buffer": "~5.1.1",
+        "string_decoder": "~1.1.1",
+        "util-deprecate": "~1.0.1"
+      }
+    },
+    "node_modules/readable-stream/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/safe-buffer": {
+      "version": "5.2.1",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
+      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/feross"
+        },
+        {
+          "type": "patreon",
+          "url": "https://www.patreon.com/feross"
+        },
+        {
+          "type": "consulting",
+          "url": "https://feross.org/support"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/safer-buffer": {
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
+      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
+      "license": "MIT"
+    },
+    "node_modules/semver": {
+      "version": "7.7.3",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
+      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/send": {
+      "version": "0.19.2",
+      "resolved": "https://registry.npmjs.org/send/-/send-0.19.2.tgz",
+      "integrity": "sha512-VMbMxbDeehAxpOtWJXlcUS5E8iXh6QmN+BkRX1GARS3wRaXEEgzCcB10gTQazO42tpNIya8xIyNx8fll1OFPrg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "destroy": "1.2.0",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "etag": "~1.8.1",
+        "fresh": "~0.5.2",
+        "http-errors": "~2.0.1",
+        "mime": "1.6.0",
+        "ms": "2.1.3",
+        "on-finished": "~2.4.1",
+        "range-parser": "~1.2.1",
+        "statuses": "~2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/send/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/serve-static": {
+      "version": "1.16.3",
+      "resolved": "https://registry.npmjs.org/serve-static/-/serve-static-1.16.3.tgz",
+      "integrity": "sha512-x0RTqQel6g5SY7Lg6ZreMmsOzncHFU7nhnRWkKgWuMTu5NN0DR5oruckMqRvacAN9d5w6ARnRBXl9xhDCgfMeA==",
+      "license": "MIT",
+      "dependencies": {
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "parseurl": "~1.3.3",
+        "send": "~0.19.1"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/setprototypeof": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz",
+      "integrity": "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==",
+      "license": "ISC"
+    },
+    "node_modules/sharp": {
+      "version": "0.33.5",
+      "resolved": "https://registry.npmjs.org/sharp/-/sharp-0.33.5.tgz",
+      "integrity": "sha512-haPVm1EkS9pgvHrQ/F3Xy+hgcuMV0Wm9vfIBSiwZ05k+xgb0PkBQpGsAA/oWdDobNaZTH5ppvHtzCFbnSEwHVw==",
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "color": "^4.2.3",
+        "detect-libc": "^2.0.3",
+        "semver": "^7.6.3"
+      },
+      "engines": {
+        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/libvips"
+      },
+      "optionalDependencies": {
+        "@img/sharp-darwin-arm64": "0.33.5",
+        "@img/sharp-darwin-x64": "0.33.5",
+        "@img/sharp-libvips-darwin-arm64": "1.0.4",
+        "@img/sharp-libvips-darwin-x64": "1.0.4",
+        "@img/sharp-libvips-linux-arm": "1.0.5",
+        "@img/sharp-libvips-linux-arm64": "1.0.4",
+        "@img/sharp-libvips-linux-s390x": "1.0.4",
+        "@img/sharp-libvips-linux-x64": "1.0.4",
+        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4",
+        "@img/sharp-libvips-linuxmusl-x64": "1.0.4",
+        "@img/sharp-linux-arm": "0.33.5",
+        "@img/sharp-linux-arm64": "0.33.5",
+        "@img/sharp-linux-s390x": "0.33.5",
+        "@img/sharp-linux-x64": "0.33.5",
+        "@img/sharp-linuxmusl-arm64": "0.33.5",
+        "@img/sharp-linuxmusl-x64": "0.33.5",
+        "@img/sharp-wasm32": "0.33.5",
+        "@img/sharp-win32-ia32": "0.33.5",
+        "@img/sharp-win32-x64": "0.33.5"
+      }
+    },
+    "node_modules/side-channel": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
+      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "object-inspect": "^1.13.3",
+        "side-channel-list": "^1.0.0",
+        "side-channel-map": "^1.0.1",
+        "side-channel-weakmap": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-list": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
+      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "object-inspect": "^1.13.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-map": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
+      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.5",
+        "object-inspect": "^1.13.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-weakmap": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
+      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.5",
+        "object-inspect": "^1.13.3",
+        "side-channel-map": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/simple-swizzle": {
+      "version": "0.2.4",
+      "resolved": "https://registry.npmjs.org/simple-swizzle/-/simple-swizzle-0.2.4.tgz",
+      "integrity": "sha512-nAu1WFPQSMNr2Zn9PGSZK9AGn4t/y97lEm+MXTtUDwfP0ksAIX4nO+6ruD9Jwut4C49SB1Ws+fbXsm/yScWOHw==",
+      "license": "MIT",
+      "dependencies": {
+        "is-arrayish": "^0.3.1"
+      }
+    },
+    "node_modules/statuses": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.2.tgz",
+      "integrity": "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/streamsearch": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
+      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/string_decoder": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.1.1.tgz",
+      "integrity": "sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "~5.1.0"
+      }
+    },
+    "node_modules/string_decoder/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/toidentifier": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.1.tgz",
+      "integrity": "sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.6"
+      }
+    },
+    "node_modules/tslib": {
+      "version": "2.8.1",
+      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
+      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
+      "license": "0BSD",
+      "optional": true
+    },
+    "node_modules/type-is": {
+      "version": "1.6.18",
+      "resolved": "https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz",
+      "integrity": "sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==",
+      "license": "MIT",
+      "dependencies": {
+        "media-typer": "0.3.0",
+        "mime-types": "~2.1.24"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/typedarray": {
+      "version": "0.0.6",
+      "resolved": "https://registry.npmjs.org/typedarray/-/typedarray-0.0.6.tgz",
+      "integrity": "sha512-/aCDEGatGvZ2BIk+HmLf4ifCJFwvKFNb9/JeZPMulfgFracn9QFcAf5GO8B/mweUjSoblS5In0cWhqpfs/5PQA==",
+      "license": "MIT"
+    },
+    "node_modules/unpipe": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
+      "integrity": "sha512-pjy2bYhSsufwWlKwPc+l3cN7+wuJlK6uz0YdJEOlQDbl6jo/YlPi4mb8agUkVC8BF7V8NuzeyPNqRksA3hztKQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/util-deprecate": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
+      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
+      "license": "MIT"
+    },
+    "node_modules/utils-merge": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/utils-merge/-/utils-merge-1.0.1.tgz",
+      "integrity": "sha512-pMZTvIkT1d+TFGvDOqodOclx0QWkkgi6Tdoa8gC8ffGAAqz9pzPTZWAybbsHHoED/ztMtkv/VoYTYyShUn81hA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4.0"
+      }
+    },
+    "node_modules/vary": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
+      "integrity": "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/xtend": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/xtend/-/xtend-4.0.2.tgz",
+      "integrity": "sha512-LKYU1iAXJXUgAXn9URjiu+MWhyUXHsvfp7mcuYm9dSUKK0/CjtrUwFAxD82/mCWbtLsGjFIad0wIsod4zrTAEQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.4"
+      }
+    }
+  }
+}
diff --git a/image_gallery/package.json b/image_gallery/package.json
new file mode 100644
index 0000000..7942074
--- /dev/null
+++ b/image_gallery/package.json
@@ -0,0 +1,14 @@
+{
+  "name": "image-gallery",
+  "version": "1.0.0",
+  "private": true,
+  "type": "module",
+  "scripts": {
+    "start": "node server.js"
+  },
+  "dependencies": {
+    "express": "^4.19.2",
+    "multer": "^1.4.5-lts.1",
+    "sharp": "^0.33.5"
+  }
+}
diff --git a/image_gallery/server.js b/image_gallery/server.js
new file mode 100644
index 0000000..84b3ba8
--- /dev/null
+++ b/image_gallery/server.js
@@ -0,0 +1,1443 @@
+import express from 'express';
+import fs from 'fs';
+import path from 'path';
+import multer from 'multer';
+import sharp from 'sharp';
+
+const app = express();
+
+const PORT = process.env.PORT || 3000;
+const IMAGES_DIR = process.env.IMAGES_DIR || '/images';
+const UPLOAD_TOKEN = process.env.UPLOAD_TOKEN || '';
+
+// 测试模式：不设置 token 时允许删除（不安全）。生产环境强烈建议设置 UPLOAD_TOKEN。
+
+const THUMBS_SUBDIR = '.thumbs';
+const THUMB_WIDTH = parseInt(process.env.THUMB_WIDTH || '480', 10) || 480;
+const THUMB_QUALITY = parseInt(process.env.THUMB_QUALITY || '70', 10) || 70;
+
+const exts = new Set(['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp', '.svg']);
+
+function isImageFile(p) {
+  return exts.has(path.extname(p).toLowerCase());
+}
+
+function safeJoin(base, target) {
+  const targetPath = path.normalize(target).replace(/^([/\\])+/, '');
+  const full = path.join(base, targetPath);
+  if (!full.startsWith(path.normalize(base))) return null;
+  return full;
+}
+
+function thumbPathFor(imageAbs) {
+  const dir = path.dirname(imageAbs);
+  const base = path.basename(imageAbs);
+  const thumbsDir = path.join(dir, THUMBS_SUBDIR);
+  const outName = base + '.w' + THUMB_WIDTH + '.q' + THUMB_QUALITY + '.webp';
+  const outAbs = path.join(thumbsDir, outName);
+  return { thumbsDir, outAbs, outName };
+}
+
+async function ensureThumb(imageAbs) {
+  const { thumbsDir, outAbs } = thumbPathFor(imageAbs);
+
+  // 已存在就直接复用
+  try {
+    const st = fs.statSync(outAbs);
+    if (st.isFile() && st.size > 0) return outAbs;
+  } catch {}
+
+  fs.mkdirSync(thumbsDir, { recursive: true });
+
+  // 生成缩略图（webp）
+  await sharp(imageAbs)
+    .rotate()
+    .resize({ width: THUMB_WIDTH, withoutEnlargement: true })
+    .webp({ quality: THUMB_QUALITY })
+    .toFile(outAbs);
+
+  return outAbs;
+}
+
+const upload = multer({
+  storage: multer.diskStorage({
+    destination: (req, file, cb) => {
+      const subdir = (req.query.dir || '').toString();
+      const abs = safeJoin(IMAGES_DIR, subdir);
+      if (!abs) return cb(new Error('bad dir'));
+      try {
+        fs.mkdirSync(abs, { recursive: true });
+        return cb(null, abs);
+      } catch (e) {
+        return cb(e);
+      }
+    },
+    filename: (req, file, cb) => {
+      // 尽量保留原文件名（去掉路径），并做一个很轻的清洗
+      const base = path.basename(file.originalname || 'upload');
+      const clean = base.replace(/[^a-zA-Z0-9._-\u4e00-\u9fa5]/g, '_');
+      cb(null, clean);
+    }
+  }),
+  limits: {
+    fileSize: 25 * 1024 * 1024, // 25MB/张（可调）
+    files: 50
+  }
+});
+
+app.post('/api/upload', upload.array('files', 50), (req, res) => {
+  if (UPLOAD_TOKEN) {
+    const token = (req.headers['x-upload-token'] || req.body?.token || '').toString();
+    if (token !== UPLOAD_TOKEN) return res.status(401).json({ error: 'bad token' });
+  }
+
+  const files = (req.files || []).map(f => ({
+    name: f.filename,
+    size: f.size,
+  }));
+  res.json({ ok: true, uploaded: files.length, files });
+});
+
+app.get('/api/thumb', async (req, res) => {
+  const subdir = (req.query.dir || '').toString();
+  const name = (req.query.name || '').toString();
+
+  const dirAbs = safeJoin(IMAGES_DIR, subdir);
+  if (!dirAbs) return res.status(400).json({ error: 'bad dir' });
+
+  const imageAbs = safeJoin(dirAbs, name);
+  if (!imageAbs) return res.status(400).json({ error: 'bad name' });
+
+  try {
+    if (!fs.existsSync(imageAbs)) return res.status(404).end();
+
+    // svg/gif 之类不做缩略图（避免复杂），直接返回原图
+    const ext = path.extname(name).toLowerCase();
+    if (ext === '.svg' || ext === '.gif') {
+      return res.sendFile(imageAbs);
+    }
+
+    const thumbAbs = await ensureThumb(imageAbs);
+    res.setHeader('Cache-Control', 'public, max-age=3600');
+    return res.sendFile(thumbAbs);
+  } catch (e) {
+    return res.status(500).json({ error: String(e) });
+  }
+});
+
+app.post('/api/delete', express.json({ limit: '1mb' }), (req, res) => {
+  // 简单鉴权：如果设置了 UPLOAD_TOKEN，则删除也必须带 token
+  if (UPLOAD_TOKEN) {
+    const token = (req.headers['x-upload-token'] || req.body?.token || '').toString();
+    if (token !== UPLOAD_TOKEN) return res.status(401).json({ error: 'bad token' });
+  }
+
+  const subdir = (req.body?.dir || '').toString();
+  const names = Array.isArray(req.body?.names) ? req.body.names.map(String) : [];
+
+  const dirAbs = safeJoin(IMAGES_DIR, subdir);
+  if (!dirAbs) return res.status(400).json({ error: 'bad dir' });
+
+  const deleted = [];
+  const failed = [];
+
+  for (const name of names) {
+    try {
+      const imageAbs = safeJoin(dirAbs, name);
+      if (!imageAbs) throw new Error('bad name');
+
+      // 删原图
+      if (fs.existsSync(imageAbs)) fs.unlinkSync(imageAbs);
+
+      // 删缩略图（如果存在）
+      try {
+        const { outAbs } = thumbPathFor(imageAbs);
+        if (fs.existsSync(outAbs)) fs.unlinkSync(outAbs);
+      } catch {}
+
+      deleted.push(name);
+    } catch (e) {
+      failed.push({ name, error: String(e) });
+    }
+  }
+
+  res.json({ ok: true, deleted, failed });
+});
+
+app.get('/api/images', async (req, res) => {
+  const subdir = (req.query.dir || '').toString();
+  const abs = safeJoin(IMAGES_DIR, subdir);
+  if (!abs) return res.status(400).json({ error: 'bad dir' });
+
+  try {
+    const entries = fs.readdirSync(abs, { withFileTypes: true });
+
+    const dirs = [];
+    const files = [];
+
+    for (const e of entries) {
+      if (e.isDirectory()) {
+        // 跳过缩略图目录
+        if (e.name === THUMBS_SUBDIR) continue;
+        dirs.push(e.name);
+      } else if (e.isFile() && isImageFile(e.name)) {
+        const rel = path.posix.join('/', subdir.split(path.sep).join('/'), e.name).replace(/\\/g, '/');
+        files.push({
+          name: e.name,
+          url: `/images${rel}`,
+          thumbUrl: `/api/thumb?dir=${encodeURIComponent(subdir)}&name=${encodeURIComponent(e.name)}`,
+        });
+      }
+    }
+
+    dirs.sort((a, b) => a.localeCompare(b));
+    files.sort((a, b) => a.name.localeCompare(b.name));
+
+    res.json({ dir: subdir, dirs, files });
+  } catch (err) {
+    res.status(500).json({ error: String(err) });
+  }
+});
+
+app.use('/images', express.static(IMAGES_DIR, {
+  fallthrough: false,
+  maxAge: '1h'
+}));
+
+app.get('/', (req, res) => {
+  res.type('html').send(`<!doctype html>
+<html lang="zh">
+<head>
+  <meta charset="utf-8" />
+  <meta name="viewport" content="width=device-width, initial-scale=1" />
+  <title>Image Gallery</title>
+  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
+  <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
+  <meta http-equiv="Pragma" content="no-cache" />
+  <meta http-equiv="Expires" content="0" />
+  <style>
+    :root {
+      --bg:#0b0e14;
+      --card:#121828;
+      --text:#e6e9f2;
+      --muted:#9aa3b2;
+      --accent:#6ea8fe;
+      /* iOS-like continuous corner radius */
+      --r-sm: clamp(12px, 2.2vw, 18px);
+      --r-md: clamp(16px, 3.0vw, 24px);
+      --r-lg: clamp(18px, 3.4vw, 28px);
+    }
+    *{ box-sizing:border-box; }
+    body{
+      margin:0;
+      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
+      color:var(--text);
+      background: #050611;
+      overscroll-behavior: none;
+      position: relative;
+      min-height: 100vh;
+    }
+    body::before{
+      content:'';
+      position: fixed;
+      inset: -20%;
+      z-index: -1;
+      background: conic-gradient(
+        from 180deg at 50% 50%,
+        rgba(255, 0, 153, .38),
+        rgba(255, 102, 0, .28),
+        rgba(255, 214, 0, .26),
+        rgba(0, 255, 170, .26),
+        rgba(0, 170, 255, .30),
+        rgba(167, 139, 250, .34),
+        rgba(255, 0, 153, .38)
+      );
+      filter: blur(40px) saturate(1.25);
+      opacity: .95;
+      transform: translate3d(0,0,0);
+      animation: bgSpin 22s linear infinite;
+    }
+    @keyframes bgSpin{
+      from { transform: rotate(0deg); }
+      to { transform: rotate(360deg); }
+    }
+    header{ padding:6px 10px; border-bottom:0; position:sticky; top:0; background:transparent; }
+    .row{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
+    .title{ font-weight:700; letter-spacing:.2px; }
+    .crumbs{ color:var(--muted); font-size:14px; }
+    .crumbs a{ color:var(--accent); text-decoration:none; }
+    .wrap{ padding:8px 10px 18px; max-width:1200px; margin:0 auto; }
+
+    /* Bubble layout (experimental) */
+    .bubbleStage{ position:relative; width:100%; height:min(78vh, 820px); border-radius:var(--r-lg);
+      border:1px solid rgba(255,255,255,.10); background: rgba(18,24,40,.22);
+      overflow:hidden; box-shadow: 0 18px 60px rgba(0,0,0,.28); }
+    .bubbleTile{ position:absolute; left:0; top:0; width:160px; height:200px; border-radius:var(--r-sm);
+      overflow:hidden; border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.06);
+      box-shadow: 0 12px 34px rgba(0,0,0,.28); }
+    .bubbleTile img{ width:100%; height:100%; object-fit:cover; display:block; border-radius:inherit; }
+    .bubbleTile.circle, .bubbleTile.circle img{ border-radius:999px; }
+    .bubbleTile.ellipse, .bubbleTile.ellipse img{ border-radius:999px; }
+    /* Masonry：用 columns 避免“大面积空洞” */
+    .grid{ column-gap: 3px; column-count: var(--cols, 3); }
+    /* 电脑端：统一宽度（固定列数），避免某些窗口算成 1 列导致“一行一个图” */
+    body.autoCols .grid{ column-count: 4; column-width: auto; }
+    @media (max-width: 900px){
+      body.autoCols .grid{ column-count: 3; }
+    }
+    @media (max-width: 680px){
+      body.autoCols .grid{ column-count: 2; }
+    }
+    @media (min-width: 1400px){
+      body.autoCols .grid{ column-count: 5; }
+    }
+    .tile{ display:block; width:100%; margin: 0 0 3px; background:transparent; border:0; border-radius:var(--r-sm); overflow:hidden; cursor:pointer; break-inside: avoid; position:relative; aspect-ratio: 4 / 5; }
+    .tile.r1{ aspect-ratio: 1 / 1; }
+    .tile.r2{ aspect-ratio: 4 / 5; }
+    .tile.r3{ aspect-ratio: 3 / 4; }
+    .tile.r4{ aspect-ratio: 2 / 3; }
+    .tile.r5{ aspect-ratio: 9 / 16; }
+    .tile.r6{ aspect-ratio: 1 / 2; }
+    /* ellipse tiles */
+    .tile.ellipse{ border-radius: 999px; }
+    .tile.ellipse img{ border-radius: 999px; }
+
+    /* some circular tiles */
+    .tile.circle{ border-radius: 999px; }
+    .tile.circle img{ border-radius: 999px; }
+    .tile img{ width:100%; height:100%; object-fit:cover; display:block; background:#0f1320; }
+    .tile.sel{ outline: 2px solid rgba(110,168,254,.9); outline-offset: -2px; }
+    .check{ position:absolute; top:8px; left:8px; width:26px; height:26px; border-radius:12px; background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.18); display:none; align-items:center; justify-content:center; color:#fff; font-weight:900; }
+    .tile.sel .check{ display:flex; }
+
+    .actionBar{ position:fixed; left:14px; right:14px; bottom:16px; z-index:40; display:none; gap:10px; align-items:center; justify-content:space-between; padding:12px; background: rgba(18,24,40,.78); border:1px solid rgba(255,255,255,.10); border-radius:var(--r-md); backdrop-filter: blur(10px); }
+    .actionBar.show{ display:flex; }
+    .actionBar .count{ color:rgba(255,255,255,.85); font-weight:800; }
+    .actionBar .btns{ display:flex; gap:10px; }
+    .danger{ background: rgba(255, 73, 73, .92) !important; color:#1a0303 !important; }
+    .ghost{ background: rgba(255,255,255,.12) !important; border:1px solid rgba(255,255,255,.18) !important; color:#fff !important; }
+    .tile .cap{ display:none; }
+    .dirs{ display:flex; flex-wrap:wrap; gap:10px; margin-bottom:8px; }
+    .dir{ border:1px dashed rgba(255,255,255,.18); color:var(--text); background:rgba(255,255,255,.03); padding:8px 10px; border-radius:10px; cursor:pointer; font-size:13px; }
+    .empty{ color:var(--muted); padding:16px; border:1px dashed rgba(255,255,255,.15); border-radius:12px; }
+
+    /* loading */
+    @keyframes glow {
+      0% { background-position: 0% 50%; }
+      50% { background-position: 100% 50%; }
+      100% { background-position: 0% 50%; }
+    }
+    @keyframes shimmer {
+      0% { transform: translateX(-60%); }
+      100% { transform: translateX(120%); }
+    }
+    .loadingWrap{ padding: 8px 0; }
+    .loadingTitle{ color: rgba(255,255,255,.75); font-weight: 800; letter-spacing:.2px; margin: 8px 2px 10px; }
+    .skeletonGrid{ column-gap: 3px; column-count: var(--cols, 3); }
+    body.autoCols .skeletonGrid{ column-count: 4; column-width: auto; }
+    @media (max-width: 900px){
+      body.autoCols .skeletonGrid{ column-count: 3; }
+    }
+    @media (max-width: 680px){
+      body.autoCols .skeletonGrid{ column-count: 2; }
+    }
+    @media (min-width: 1400px){
+      body.autoCols .skeletonGrid{ column-count: 5; }
+    }
+    .sk{ display:inline-block; width:100%; margin:0 0 3px; border-radius:10px; overflow:hidden; break-inside: avoid; background: rgba(255,255,255,.06); position:relative; }
+    .sk::after{ content:''; position:absolute; inset:0; background: linear-gradient(90deg, transparent, rgba(255,255,255,.14), transparent); transform: translateX(-60%); animation: shimmer 1.1s ease-in-out infinite; }
+    .sk.h1{ height: 160px; }
+    .sk.h2{ height: 220px; }
+    .sk.h3{ height: 300px; }
+    .bar{ display:flex; gap:10px; align-items:center; }
+    input{ background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.12); color:var(--text); border-radius:var(--r-sm); padding:10px 12px; min-width:240px; outline:none; }
+    input:focus{ border-color: rgba(110,168,254,.55); box-shadow: 0 0 0 3px rgba(110,168,254,.15); }
+    button{ background:var(--accent); border:0; color:#061225; padding:10px 12px; border-radius:var(--r-sm); cursor:pointer; font-weight:800; }
+    button:active{ transform: translateY(1px); }
+
+    /* floating action buttons */
+    .fab{ position: fixed; right: 14px; bottom: 88px; display:flex; flex-direction:column; gap:10px; z-index: 30; }
+    body.immersive .fab #settingsBtn, body.immersive .fab #uploadBtn{ display:none; }
+    /* autoplay(immersive) 时把播放按钮放到底部中间，方便点停 */
+    body.immersive .fab{ left:50%; right:auto; bottom:18px; transform:translateX(-50%); }
+    body.immersive .fab button{ width:56px; height:56px; border-radius:var(--r-md); font-size:28px; }
+    /* immersive mode keeps X visible */
+    .fab button{ width: 44px; height: 44px; padding:0; display:grid; place-items:center; border-radius: var(--r-sm); background: rgba(18,24,40,.78); border: 1px solid rgba(255,255,255,.10); color: var(--text); backdrop-filter: blur(10px); font-size: 24px; line-height: 1; }
+    /* upload button no longer uses special primary style */
+
+    /* lightbox */
+    .lb{ position:fixed; inset:0; background:rgba(0,0,0,.25); display:none; align-items:center; justify-content:center; padding:10px; overscroll-behavior: contain; touch-action: none; backdrop-filter: blur(10px); }
+    .lb.open{ display:flex; }
+    .lb-inner{ width:100%; max-width: min(1400px, 100vw); height: min(96vh, 980px); }
+
+    /* 预览区按 4:1 分配：上面主图 4fr，下面缩略条 1fr */
+    .lb-stage{ height:100%; display:grid; grid-template-rows: 4fr 1fr; gap:10px; min-height:0; }
+    .mainWrap{ position:relative; min-height:0; border-radius:var(--r-lg); overflow:hidden; background:transparent; box-shadow: 0 18px 50px rgba(0,0,0,.35); padding:0; border:1px solid rgba(255,255,255,.10); }
+    /* 主图填满外框：用 cover（会裁切一点边缘） */
+    .lb-img{ width:100%; height:100%; object-fit:cover; border-radius:var(--r-lg); background:transparent; display:block; transform-origin: 50% 50%; transition: transform .12s ease; will-change: transform; }
+
+    .thumbs{ height: 100%; min-height: 64px; display:flex; align-items:center; gap:8px; overflow-x:auto; padding:8px 6px; -webkit-overflow-scrolling: touch; scrollbar-width: none; background: rgba(0,0,0,.18); border: 1px solid rgba(255,255,255,.08); border-radius: 14px; touch-action: pan-x; }
+    .immersive .thumbs{ display:none; }
+    .immersive .lb-stage{ grid-template-rows: 1fr; }
+    .thumbs::-webkit-scrollbar{ display:none; }
+    .thumb{ flex: 0 0 auto; width:92px; height:64px; border-radius:var(--r-sm); overflow:hidden; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); cursor:pointer; }
+    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; pointer-events:none; }
+    .thumb.active{ border-color: rgba(110,168,254,.8); box-shadow: 0 0 0 2px rgba(110,168,254,.22); }
+
+    /* one-time hints */
+    .hint{ position:absolute; padding:8px 10px; border-radius:12px; background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.18); color:#fff; font-weight:800; font-size:12px; letter-spacing:.2px; backdrop-filter: blur(8px); pointer-events:none; opacity:0; transform: translateY(6px); }
+    .hint.show{ opacity:1; transform: translateY(0); transition: opacity .25s ease, transform .25s ease; }
+    .hint.fade{ opacity:0; transform: translateY(10px); transition: opacity .6s ease, transform .6s ease; }
+
+    /* lightbox controls auto-hide */
+    .ctl{ transition: opacity .25s ease, transform .25s ease; }
+    .ctlHide .ctl{ opacity:0; transform: translateY(6px); pointer-events:none; }
+    @media (max-width: 520px){
+      input{ min-width: 180px; width:100%; }
+    }
+  </style>
+</head>
+<body>
+  <header>
+    <div class="row">
+      <div>
+        <!-- crumbs hidden for clean UI -->
+        <div class="crumbs" id="crumbs" style="display:none"></div>
+      </div>
+      <!-- controls moved into settings -->
+    </div>
+  </header>
+
+  <div class="wrap">
+    <div class="dirs" id="dirs"></div>
+    <div id="content"></div>
+  </div>
+
+  <div class="actionBar" id="actionBar">
+    <div class="count" id="selCount">已选择 0</div>
+    <div class="btns">
+      <button id="toggleAll" class="ghost">全选</button>
+      <button id="cancelSel" class="ghost">取消</button>
+      <button id="deleteSel" class="danger">删除</button>
+    </div>
+  </div>
+
+  <div class="fab">
+    <button id="playPref" title="自动播放" aria-label="自动播放">▶</button>
+    <button id="settingsBtn" title="配置" aria-label="配置">⚙️</button>
+    <button id="uploadBtn" title="上传" aria-label="上传">↑</button>
+  </div>
+
+  <input id="file" type="file" accept="image/*" multiple style="display:none" />
+
+  <div class="lb" id="lb">
+    <div class="lb-inner">
+      <div class="lb-stage">
+        <div class="mainWrap" style="position:relative;">
+          <img class="lb-img" id="lbImg" />
+          <button id="lbPrev" class="ctl" aria-label="上一张" style="position:absolute;left:12px;top:65%;transform:translateY(-50%);background:rgba(255, 0, 153, .38);border:1px solid rgba(255, 0, 153, .55);color:#fff;border-radius:12px;padding:8px 10px;cursor:pointer;">‹</button>
+          <button id="lbNext" class="ctl" aria-label="下一张" style="position:absolute;right:12px;top:65%;transform:translateY(-50%);background:rgba(0, 255, 240, .30);border:1px solid rgba(0, 255, 240, .55);color:#fff;border-radius:12px;padding:8px 10px;cursor:pointer;">›</button>
+          <button id="lbX" aria-label="关闭" style="position:absolute;right:12px;top:12px;background:rgba(0,0,0,.42);border:1px solid rgba(255,255,255,.22);color:#fff;border-radius:var(--r-sm);width:44px;height:44px;padding:0;cursor:pointer;font-size:24px;line-height:1;display:grid;place-items:center;">✕</button>
+
+          <div id="hintSwipe" class="hint" style="left:50%;top:14px;transform:translate(-50%,6px);">左右滑动切换 · 双击/双指放大</div>
+          <div id="hintThumbs" class="hint" style="left:50%;bottom:78px;transform:translate(-50%,6px);">底部滑动选图</div>
+        </div>
+        <div class="thumbs" id="thumbs"></div>
+      </div>
+      <a id="lbOpen" target="_blank" rel="noreferrer" style="display:none;">open</a>
+      <div id="lbName" style="display:none"></div>
+    </div>
+  </div>
+
+  <!-- settings modal -->
+  <div class="lb" id="settings" style="background:rgba(0,0,0,.55)">
+    <div class="lb-inner" style="max-width:520px;">
+      <div style="background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:14px;">
+        <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
+          <div style="font-weight:800;">显示配置</div>
+          <a href="#" id="settingsClose" style="color:var(--accent);text-decoration:none;">关闭</a>
+        </div>
+        <div style="margin-top:12px;color:var(--muted);font-size:13px;">本地图片展示（Gallery）</div>
+        <div style="margin-top:6px;color:var(--muted);font-size:13px;">手机建议 2~3 列，空洞会更少。</div>
+<!-- autoplay moved to big-image toolbar -->
+        <div style="display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap;">
+          <label style="display:flex;gap:8px;align-items:center;">
+            <span style="min-width:60px;color:var(--muted);">目录</span>
+            <input id="dir" placeholder="子目录（例如: 2026/01）" style="min-width:180px;" />
+          </label>
+          <button id="go" style="background:rgba(255,255,255,.14);border:1px solid rgba(255,255,255,.18);color:#fff;">打开</button>
+        </div>
+
+        <div style="display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap;">
+          <label style="display:flex;gap:8px;align-items:center;">
+            <span style="min-width:60px;color:var(--muted);">列数</span>
+            <select id="cols" style="background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);color:var(--text);border-radius:10px;padding:10px 12px;">
+              <option value="auto">自动（按屏幕宽度平铺）</option>
+              <option value="1">1</option>
+              <option value="2">2</option>
+              <option value="3">3</option>
+              <option value="4">4</option>
+              <option value="5">5</option>
+            </select>
+          </label>
+          <button id="apply" style="background:var(--accent);border:0;color:#061225;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:800;">应用</button>
+          <button id="uploadInSettings" style="background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.18);color:#fff;padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:800;">上传</button>
+          <button id="bubbleModeBtn" style="background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.18);color:#fff;padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:900;">泡泡布局：关</button>
+          <button id="enterDelete" style="background:rgba(255, 73, 73, .92);border:0;color:#1a0303;padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:900;">删除模式</button>
+        </div>
+        <div style="margin-top:10px;color:var(--muted);font-size:12px;">提示：删除模式下点击图片可选中，支持全选/删除；完成后点“退出删除模式”。</div>
+      </div>
+    </div>
+  </div>
+
+<script>
+  const $ = (id) => document.getElementById(id);
+
+  function esc(s){ return (s||'').replace(/[&<>\"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',"'":'&#39;'}[c])); }
+
+  function setCrumbs(dir){
+    const parts = (dir || '').split(/[\\/]+/).filter(Boolean);
+    let html = '<a href="#" data-dir="">/</a>';
+    let cur = '';
+    for (const p of parts){
+      cur = cur ? (cur + '/' + p) : p;
+      html += ' / ' + '<a href="#" data-dir="' + esc(cur) + '">' + esc(p) + '</a>';
+    }
+    $('crumbs').innerHTML = html;
+    [...$('crumbs').querySelectorAll('a[data-dir]')].forEach(a => {
+      a.addEventListener('click', (e) => {
+        e.preventDefault();
+        load(a.getAttribute('data-dir') || '');
+      });
+    });
+  }
+
+  let currentFiles = [];
+  let currentIndex = -1;
+
+  // bubble layout (experimental)
+  let bubbleMode = false;
+  try { bubbleMode = (localStorage.getItem('gallery_bubble') === '1'); } catch {}
+  function setBubbleMode(on){
+    bubbleMode = !!on;
+    try { localStorage.setItem('gallery_bubble', bubbleMode ? '1' : '0'); } catch {}
+    if ($('bubbleModeBtn')) $('bubbleModeBtn').textContent = '泡泡布局：' + (bubbleMode ? '开' : '关');
+  }
+
+  // selection
+  let selectMode = false;
+  const selected = new Set();
+
+  function updateActionBar(){
+    const bar = $('actionBar');
+    const n = selected.size;
+    $('selCount').textContent = '已选择 ' + n;
+
+    // 删除模式下始终显示底部操作条（即便还没选中）
+    if (selectMode) bar.classList.add('show');
+    else bar.classList.remove('show');
+
+    // 同步“全选/取消全选”文案
+    const total = document.querySelectorAll('.tile[data-name]').length;
+    const btn = $('toggleAll');
+    if (btn) btn.textContent = (total > 0 && n >= total) ? '取消全选' : '全选';
+  }
+
+  function enterSelectMode(){
+    selectMode = true;
+    updateActionBar();
+    const btn = $('enterDelete');
+    if (btn) btn.textContent = '退出删除模式';
+  }
+
+  function exitSelectMode(){
+    selectMode = false;
+    selected.clear();
+    document.querySelectorAll('.tile.sel').forEach(t => t.classList.remove('sel'));
+    updateActionBar();
+    const btn = $('enterDelete');
+    if (btn) btn.textContent = '删除模式';
+  }
+
+  function selectAll(){
+    if (!selectMode) enterSelectMode();
+    selected.clear();
+    document.querySelectorAll('.tile[data-name]').forEach(t => {
+      const name = t.getAttribute('data-name');
+      if (!name) return;
+      selected.add(name);
+      t.classList.add('sel');
+    });
+    updateActionBar();
+  }
+
+  function clearAll(){
+    selected.clear();
+    document.querySelectorAll('.tile.sel').forEach(t => t.classList.remove('sel'));
+    updateActionBar();
+  }
+
+  function toggleSelect(name, tile, forceOn=false){
+    if (!selectMode) return;
+    const on = forceOn ? false : selected.has(name);
+    if (on) {
+      selected.delete(name);
+      tile.classList.remove('sel');
+    } else {
+      selected.add(name);
+      tile.classList.add('sel');
+    }
+    updateActionBar();
+  }
+
+  function renderSkeleton(){
+    const cols = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cols') || '2', 10) || 2;
+    const count = Math.max(10, cols * 10);
+    const heights = ['h1','h1','h2','h1','h2','h3','h1','h2','h1','h2'];
+    let html = '<div class="loadingWrap">' +
+      '<div class="loadingTitle">加载中…</div>' +
+      '<div class="skeletonGrid">';
+    for (let i=0;i<count;i++){
+      const h = heights[i % heights.length];
+      html += '<div class="sk ' + h + '"></div>';
+    }
+    html += '</div></div>';
+    $('content').innerHTML = html;
+  }
+
+  async function load(dir){
+    $('dir').value = dir;
+    setCrumbs(dir);
+    $('dirs').innerHTML = '';
+    renderSkeleton();
+
+    const r = await fetch('/api/images?dir=' + encodeURIComponent(dir));
+    const data = await r.json();
+
+    if (data.error){
+      $('content').innerHTML = '<div class="empty">错误：' + esc(data.error) + '</div>';
+      return;
+    }
+
+    if (data.dirs && data.dirs.length){
+      for (const d of data.dirs){
+        const el = document.createElement('div');
+        el.className = 'dir';
+        el.textContent = '📁 ' + d;
+        el.onclick = () => load(dir ? (dir + '/' + d) : d);
+        $('dirs').appendChild(el);
+      }
+    }
+
+    if (!data.files || !data.files.length){
+      currentFiles = [];
+      currentIndex = -1;
+      $('content').innerHTML = '<div class="empty">这个目录没有图片（支持 jpg/png/webp/gif…）。</div>';
+      return;
+    }
+
+    currentFiles = data.files;
+    currentIndex = -1;
+
+    function hashString(s){
+      let h = 2166136261;
+      for (let i=0;i<s.length;i++){
+        h ^= s.charCodeAt(i);
+        h = Math.imul(h, 16777619);
+      }
+      return (h >>> 0);
+    }
+
+    // Bubble layout (experimental): physics packing
+    if (bubbleMode && window.Matter) {
+      const MAX = 80;
+      const files = data.files.slice(0, MAX);
+
+      const stage = document.createElement('div');
+      stage.className = 'bubbleStage';
+      stage.id = 'bubbleStage';
+      $('content').innerHTML = '';
+      $('content').appendChild(stage);
+
+      const { Engine, Bodies, Composite, Runner } = Matter;
+      const engine = Engine.create();
+      engine.gravity.y = 0.85;
+
+      const rect = stage.getBoundingClientRect();
+      const W = Math.max(320, Math.floor(rect.width));
+      const H = Math.max(420, Math.floor(rect.height));
+
+      const wallOpts = { isStatic:true, restitution:0.85, friction:0.02 };
+      Composite.add(engine.world, [
+        Bodies.rectangle(W/2, -24, W+200, 48, wallOpts),
+        Bodies.rectangle(W/2, H+24, W+200, 48, wallOpts),
+        Bodies.rectangle(-24, H/2, 48, H+200, wallOpts),
+        Bodies.rectangle(W+24, H/2, 48, H+200, wallOpts),
+      ]);
+
+      const baseW = Math.min(200, Math.max(140, Math.floor(W/6)));
+      const bodies = [];
+      let prevDecor = false;
+
+      for (let i=0;i<files.length;i++){
+        const f = files[i];
+        const h = hashString(f.name);
+        const rr = (h % 1000) / 1000;
+
+        const el = document.createElement('div');
+        el.className = 'bubbleTile';
+        el.setAttribute('data-name', f.name);
+
+        // shapes only in middle band
+        const n = files.length;
+        const inMiddleBand = (i >= 2) && (i <= n - 3);
+        let decorated = false;
+        if (!prevDecor && inMiddleBand && rr < 0.28) {
+          el.classList.add('circle');
+          decorated = true;
+        } else if (!prevDecor && inMiddleBand && rr < 0.70) {
+          el.classList.add('ellipse');
+          decorated = true;
+        }
+        prevDecor = decorated;
+
+        // sizes
+        let w = baseW;
+        let hpx = Math.round(baseW * 1.25);
+        if (el.classList.contains('circle')) {
+          hpx = w;
+        } else if (el.classList.contains('ellipse')) {
+          hpx = Math.round(w * 0.72);
+        } else {
+          const ar = (h % 6) + 1;
+          const ratios = { 1:1.00, 2:1.25, 3:1.33, 4:1.55, 5:1.80, 6:2.00 };
+          hpx = Math.round(w * (ratios[ar] || 1.25));
+        }
+        el.style.width = w + 'px';
+        el.style.height = hpx + 'px';
+
+        const img = document.createElement('img');
+        img.loading = 'lazy';
+        img.src = f.thumbUrl || f.url;
+        img.alt = f.name;
+        el.appendChild(img);
+
+        el.addEventListener('click', () => {
+          const idx = data.files.findIndex(x => x.name === f.name);
+          openLb(Math.max(0, idx));
+        });
+
+        stage.appendChild(el);
+
+        const x = 40 + (rr * (W - w - 80)) + w/2;
+        const y = 30 + (i * 5);
+        const body = Bodies.rectangle(x, y, w, hpx, {
+          restitution:0.88,
+          friction:0.04,
+          frictionAir:0.03,
+        });
+        Composite.add(engine.world, body);
+        bodies.push({ body, el, w, h: hpx });
+      }
+
+      const runner = Runner.create();
+      Runner.run(runner, engine);
+
+      (function raf(){
+        for (const it of bodies){
+          const b = it.body;
+          it.el.style.transform = 'translate(' + (b.position.x - it.w/2) + 'px,' + (b.position.y - it.h/2) + 'px) rotate(' + b.angle + 'rad)';
+        }
+        requestAnimationFrame(raf);
+      })();
+
+      return;
+    }
+
+    const grid = document.createElement('div');
+    grid.className = 'grid';
+
+    let prevDecor = false; // avoid consecutive circle/ellipse
+    for (let i = 0; i < data.files.length; i++){
+      const f = data.files[i];
+      const tile = document.createElement('div');
+      tile.className = 'tile';
+      tile.setAttribute('data-name', f.name);
+
+      // 稳定“随机”尺寸：同一张图每次都一样（按文件名 hash）
+      const h = hashString(f.name);
+      const r = (h % 1000) / 1000;
+
+      // 形状点缀：圆形 + 胶囊（稳定随机）
+      // 规则：不要出现在最开始/最末尾（尤其第一张），只在“中间区间”点缀。
+      // - circle：强制 1:1
+      // - ellipse：胶囊感（更瘦长）
+      const n = data.files.length;
+      const inMiddleBand = (i >= 2) && (i <= n - 3); // 跳过头2张 + 尾2张
+
+      let decorated = false;
+      if (!prevDecor && inMiddleBand && r < 0.40) {
+        tile.classList.add('circle');
+        tile.classList.add('r1');
+        decorated = true;
+      } else if (!prevDecor && inMiddleBand && r < 0.70) {
+        // 椭圆：保留不同高度比例，呈现椭圆/软边卡片
+        tile.classList.add('ellipse');
+        const ar = (h % 5) + 2; // r2..r6
+        tile.classList.add('r' + ar);
+        decorated = true;
+      } else {
+        // 宽度保持一致（列宽固定），只随机高度（用不同 aspect-ratio）
+        const ar = (h % 6) + 1;
+        tile.classList.add('r' + ar);
+      }
+      prevDecor = decorated;
+
+      const thumb = f.thumbUrl || f.url;
+      tile.innerHTML = '<div class="check">✓</div>' +
+        '<img loading="lazy" src="' + esc(thumb) + '" data-full="' + esc(f.url) + '" alt="" />' +
+        '<div class="cap"></div>';
+
+      // click 打开预览（在“选择模式”下改为切换选择）
+      tile.addEventListener('click', (e) => {
+        if (selectMode) {
+          e.preventDefault();
+          toggleSelect(f.name, tile);
+          return;
+        }
+        openLb(i);
+      });
+
+      // 长按进入选择模式并选中
+      let lp = null;
+      tile.addEventListener('touchstart', (e) => {
+        if (selectMode) return;
+        lp = setTimeout(() => {
+          enterSelectMode();
+          toggleSelect(f.name, tile, true);
+        }, 420);
+      }, { passive: true });
+      tile.addEventListener('touchend', () => { if (lp) clearTimeout(lp); lp = null; }, { passive: true });
+      tile.addEventListener('touchmove', () => { if (lp) clearTimeout(lp); lp = null; }, { passive: true });
+
+      // 右键（桌面）进入选择
+      tile.addEventListener('contextmenu', (e) => {
+        e.preventDefault();
+        if (!selectMode) enterSelectMode();
+        toggleSelect(f.name, tile);
+      });
+
+      grid.appendChild(tile);
+    }
+    $('content').innerHTML = '';
+    $('content').appendChild(grid);
+  }
+
+  function applyCols(cols){
+    const v = (cols == null ? '' : String(cols)).trim();
+    if (v === 'auto') {
+      document.body.classList.add('autoCols');
+      document.documentElement.style.setProperty('--cols', '3'); // fallback
+      try { localStorage.setItem('gallery_cols', 'auto'); } catch {}
+      if ($('cols')) $('cols').value = 'auto';
+      return;
+    }
+
+    document.body.classList.remove('autoCols');
+    const n = Math.max(1, Math.min(8, parseInt(v || '3', 10) || 3));
+    document.documentElement.style.setProperty('--cols', String(n));
+    try { localStorage.setItem('gallery_cols', String(n)); } catch {}
+    if ($('cols')) $('cols').value = String(n);
+  }
+
+  function renderThumbs(){
+    const el = $('thumbs');
+    if (!el) return;
+    if (!currentFiles.length){ el.innerHTML = ''; return; }
+
+    // 只渲染附近一段，避免几千张时卡
+    const total = currentFiles.length;
+    const radius = 12;
+    let start = Math.max(0, currentIndex - radius);
+    let end = Math.min(total, currentIndex + radius + 1);
+
+    // 如果开头/结尾不足，尽量补齐数量
+    const want = Math.min(total, radius * 2 + 1);
+    while (end - start < want) {
+      if (start > 0) start--;
+      else if (end < total) end++;
+      else break;
+    }
+
+    let html = '';
+    for (let i = start; i < end; i++){
+      const f = currentFiles[i];
+      const t = f.thumbUrl || f.url;
+      html += '<div class="thumb' + (i === currentIndex ? ' active' : '') + '" data-idx="' + i + '">' +
+        '<img loading="eager" src="' + esc(t) + '" alt="" />' +
+      '</div>';
+    }
+    el.innerHTML = html;
+    [...el.querySelectorAll('.thumb[data-idx]')].forEach(n => {
+      n.addEventListener('click', (e) => {
+        e.preventDefault();
+        e.stopPropagation();
+        const idx = parseInt(n.getAttribute('data-idx') || '0', 10);
+        showLb(idx);
+      });
+    });
+
+    // 滚动让当前缩略图尽量在中间
+    const active = el.querySelector('.thumb.active');
+    if (active) {
+      const left = active.offsetLeft - (el.clientWidth / 2) + (active.clientWidth / 2);
+      el.scrollTo({ left: Math.max(0, left), behavior: 'smooth' });
+    }
+  }
+
+  let zoom = 1;
+  let panX = 0;
+  let panY = 0;
+
+  function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }
+
+  let rafPending = false;
+  function applyZoom(){
+    if (rafPending) return;
+    rafPending = true;
+    requestAnimationFrame(() => {
+      rafPending = false;
+      const img = $('lbImg');
+      // translate3d 更容易走 GPU 合成
+      img.style.transform = 'translate3d(' + panX + 'px,' + panY + 'px,0) scale(' + zoom + ')';
+    });
+  }
+
+  function resetZoom(){
+    zoom = 1; panX = 0; panY = 0;
+    $('lbImg').style.transformOrigin = '50% 50%';
+    applyZoom();
+  }
+
+  function zoomAt(clientX, clientY){
+    const img = $('lbImg');
+    const rect = img.getBoundingClientRect();
+    const x = ((clientX - rect.left) / rect.width) * 100;
+    const y = ((clientY - rect.top) / rect.height) * 100;
+    img.style.transformOrigin = clamp(x, 0, 100) + '% ' + clamp(y, 0, 100) + '%';
+
+    // 1x -> 2x -> 3x -> 1x
+    if (zoom === 1) zoom = 2;
+    else if (zoom === 2) zoom = 3;
+    else { zoom = 1; panX = 0; panY = 0; }
+    applyZoom();
+  }
+
+  function showHintsOnce(){
+    try {
+      if (localStorage.getItem('gallery_hints_v1') === '1') return;
+    } catch {}
+
+    const h1 = $('hintSwipe');
+    const h2 = $('hintThumbs');
+    if (!h1 || !h2) return;
+
+    // show
+    h1.classList.add('show');
+    h2.classList.add('show');
+
+    // fade out
+    setTimeout(() => {
+      h1.classList.remove('show');
+      h2.classList.remove('show');
+      h1.classList.add('fade');
+      h2.classList.add('fade');
+    }, 2200);
+
+    // remove
+    setTimeout(() => {
+      h1.remove();
+      h2.remove();
+    }, 3200);
+
+    try { localStorage.setItem('gallery_hints_v1', '1'); } catch {}
+  }
+
+  // controls: 只做一次性引导（后续不再弹出左右/关闭按钮）
+  let ctlTimer = null;
+  function showControlsOnce(){
+    const lb = $('lb');
+    try {
+      if (localStorage.getItem('gallery_controls_v1') === '1') {
+        lb.classList.add('ctlHide');
+        return;
+      }
+    } catch {}
+
+    lb.classList.remove('ctlHide');
+    if (ctlTimer) clearTimeout(ctlTimer);
+    ctlTimer = setTimeout(() => {
+      lb.classList.add('ctlHide');
+    }, 1800);
+
+    try { localStorage.setItem('gallery_controls_v1', '1'); } catch {}
+  }
+
+  const AUTOPLAY_MS = 3000;
+  let autoplayEnabled = false;
+  let autoplayTimer = null;
+
+  function updatePlayBtn(){
+    const btn = $('playPref');
+    if (!btn) return;
+    // 按“开关意图”显示：开启=❚❚（可点暂停），关闭=▶（可点播放）
+    btn.textContent = autoplayEnabled ? '❚❚' : '▶';
+  }
+
+  let pausedByTouch = false;
+
+  function stopAutoplay(){
+    if (autoplayTimer) clearInterval(autoplayTimer);
+    autoplayTimer = null;
+    updatePlayBtn();
+  }
+
+  function pauseAutoplayForTouch(){
+    if (!autoplayEnabled) return;
+    if (!autoplayTimer) return;
+    pausedByTouch = true;
+    stopAutoplay();
+  }
+
+  function resumeAutoplayAfterTouch(){
+    if (!pausedByTouch) return;
+    pausedByTouch = false;
+    if (autoplayEnabled) startAutoplay();
+  }
+
+  function startAutoplay(){
+    stopAutoplay();
+    if (!autoplayEnabled) return;
+    autoplayTimer = setInterval(() => {
+      nextLb();
+    }, AUTOPLAY_MS);
+    updatePlayBtn();
+  }
+
+  function setAutoplayEnabled(on){
+    autoplayEnabled = !!on;
+    const lb = $('lb');
+    if (autoplayEnabled) {
+      lb.classList.add('immersive');
+      document.body.classList.add('immersive');
+      startAutoplay();
+    } else {
+      lb.classList.remove('immersive');
+      document.body.classList.remove('immersive');
+      stopAutoplay();
+    }
+  }
+
+  function showLbInternal(index){
+    if (!currentFiles.length) return;
+    if (index < 0) index = currentFiles.length - 1;
+    if (index >= currentFiles.length) index = 0;
+    currentIndex = index;
+    const f = currentFiles[currentIndex];
+
+    // 切换图片时才加载原图
+    $('lbImg').src = f.url;
+    $('lbOpen').href = f.url;
+
+    resetZoom();
+    renderThumbs();
+    const lb = $('lb');
+    lb.classList.add('open');
+    lb.classList.add('ctlHide');
+    showControlsOnce();
+    showHintsOnce();
+
+    // 注意：这里不再重置 autoplay，避免自动播放切一张就停
+    updatePlayBtn();
+  }
+
+  function openLb(index){
+    // 每次“进入大图模式”默认关闭自动播放
+    autoplayEnabled = false;
+    stopAutoplay();
+    showLbInternal(index);
+  }
+
+  function closeLb(){
+    const lb = $('lb');
+    lb.classList.remove('open');
+    lb.classList.remove('immersive');
+    document.body.classList.remove('immersive');
+    autoplayEnabled = false;
+    pausedByTouch = false;
+    stopAutoplay();
+    resetZoom();
+    updatePlayBtn();
+  }
+
+  function prevLb(){
+    showLbInternal(currentIndex - 1);
+  }
+
+  function nextLb(){
+    showLbInternal(currentIndex + 1);
+  }
+
+  // floating play button: if not in lightbox, open first image then start autoplay
+  const playPref = $('playPref');
+  if (playPref) {
+    async function ensureFilesLoaded(){
+      if (currentFiles && currentFiles.length) return;
+      const dir = ($('dir') && $('dir').value ? $('dir').value : '').trim();
+      await load(dir);
+    }
+
+    // 点击立即暂停/继续（用户明确需要可控）
+    playPref.addEventListener('click', async (e) => {
+      e.preventDefault();
+      e.stopPropagation();
+
+      // 如果大图没打开：确保列表已加载 -> 打开第一张并开始播放
+      if (!$('lb').classList.contains('open')) {
+        await ensureFilesLoaded();
+        if (!currentFiles || !currentFiles.length) return;
+        openLb(0);
+        setAutoplayEnabled(true);
+        startAutoplay();
+        return;
+      }
+
+      // 大图已打开：如果是“手势临时暂停”，优先恢复播放（不要误当成关掉）
+      if (autoplayEnabled && pausedByTouch && !autoplayTimer) {
+        resumeAutoplayAfterTouch();
+        return;
+      }
+
+      // 否则：切换播放/暂停
+      setAutoplayEnabled(!autoplayEnabled);
+      if (autoplayEnabled) startAutoplay();
+      else stopAutoplay();
+    });
+  }
+
+  // lbPlay removed; use floating playPref only
+
+  $('lbX').addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); closeLb(); });
+  $('lbPrev').addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); prevLb(); });
+  $('lbNext').addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); nextLb(); });
+  $('lb').addEventListener('click', (e) => {
+    // 点击遮罩关闭；内容区点击不再弹出按钮（保持干净）
+    if (e.target === $('lb')) closeLb();
+  });
+
+  // 键盘：左右 / Esc / Space 播放暂停
+  document.addEventListener('keydown', (e) => {
+    if (!$('lb').classList.contains('open')) return;
+
+    // Space：播放/暂停（避免页面滚动）
+    if (e.code === 'Space' || e.key === ' ') {
+      e.preventDefault();
+      // 手势临时暂停时，优先恢复
+      if (autoplayEnabled && pausedByTouch && !autoplayTimer) {
+        resumeAutoplayAfterTouch();
+        return;
+      }
+      setAutoplayEnabled(!autoplayEnabled);
+      if (autoplayEnabled) startAutoplay();
+      else stopAutoplay();
+      return;
+    }
+
+    if (e.key === 'ArrowLeft') prevLb();
+    else if (e.key === 'ArrowRight') nextLb();
+    else if (e.key === 'Escape') closeLb();
+  });
+
+  // 触摸滑动（手机左右滑） + 缩放后拖动查看细节 + 双指捏合缩放
+  let touchX = null;
+  let touchY = null;
+  let dragX = null;
+  let dragY = null;
+
+  let pinchStartDist = null;
+  let pinchStartZoom = 1;
+
+  function dist(t1, t2){
+    const dx = t1.clientX - t2.clientX;
+    const dy = t1.clientY - t2.clientY;
+    return Math.sqrt(dx*dx + dy*dy);
+  }
+
+  function midpoint(t1, t2){
+    return { x: (t1.clientX + t2.clientX)/2, y: (t1.clientY + t2.clientY)/2 };
+  }
+
+  const lbEl = $('lb');
+  lbEl.addEventListener('touchstart', (e) => {
+    if (!lbEl.classList.contains('open')) return;
+
+    // 在缩略图条上允许横向滚动
+    if (e.target && e.target.closest && e.target.closest('#thumbs')) return;
+
+    // 用户开始手势操作：先临时暂停自动播放，手指离开后再恢复
+    pauseAutoplayForTouch();
+
+    if (e.touches && e.touches.length === 2) {
+      // pinch start
+      pinchStartDist = dist(e.touches[0], e.touches[1]);
+      pinchStartZoom = zoom;
+      const m = midpoint(e.touches[0], e.touches[1]);
+      const img = $('lbImg');
+      // pinch 时关掉 transition，避免每帧补间导致卡顿
+      img.style.transition = 'none';
+      const rect = img.getBoundingClientRect();
+      const ox = ((m.x - rect.left) / rect.width) * 100;
+      const oy = ((m.y - rect.top) / rect.height) * 100;
+      img.style.transformOrigin = clamp(ox,0,100) + '% ' + clamp(oy,0,100) + '%';
+      e.preventDefault();
+      return;
+    }
+
+    const t = e.touches && e.touches[0];
+    if (!t) return;
+    touchX = t.clientX;
+    touchY = t.clientY;
+    dragX = t.clientX;
+    dragY = t.clientY;
+  }, { passive: false });
+
+  lbEl.addEventListener('touchmove', (e) => {
+    if (!lbEl.classList.contains('open')) return;
+    if (e.target && e.target.closest && e.target.closest('#thumbs')) return;
+
+    // pinch zoom
+    if (e.touches && e.touches.length === 2 && pinchStartDist) {
+      e.preventDefault();
+      const d = dist(e.touches[0], e.touches[1]);
+      const scale = d / pinchStartDist;
+      zoom = clamp(pinchStartZoom * scale, 1, 4);
+      applyZoom();
+      return;
+    }
+
+    const t = e.touches && e.touches[0];
+    if (!t || touchX == null || touchY == null) return;
+    const dx = t.clientX - touchX;
+    const dy = t.clientY - touchY;
+
+    // 缩放状态：拖动平移看细节
+    if (zoom > 1 && dragX != null && dragY != null) {
+      e.preventDefault();
+      panX += (t.clientX - dragX);
+      panY += (t.clientY - dragY);
+      dragX = t.clientX;
+      dragY = t.clientY;
+      applyZoom();
+      return;
+    }
+
+    // 非缩放：横向滑动为主时，preventDefault 尝试阻止浏览器导航手势
+    if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 10) {
+      e.preventDefault();
+    }
+  }, { passive: false });
+
+  lbEl.addEventListener('touchend', (e) => {
+    if (!lbEl.classList.contains('open')) return;
+
+    // pinch end
+    if (pinchStartDist && (!e.touches || e.touches.length < 2)) {
+      pinchStartDist = null;
+      pinchStartZoom = zoom;
+      // pinch 结束恢复 transition
+      const img = $('lbImg');
+      img.style.transition = 'transform .12s ease';
+    }
+
+    // 所有手指离开后，恢复自动播放
+    if (!e.touches || e.touches.length === 0) {
+      resumeAutoplayAfterTouch();
+    }
+
+    if (touchX == null) {
+      dragX = dragY = null;
+      return;
+    }
+
+    // 缩放中不做翻页（避免误触）
+    if (zoom > 1) {
+      touchX = touchY = dragX = dragY = null;
+      return;
+    }
+
+    const endX = e.changedTouches && e.changedTouches[0] ? e.changedTouches[0].clientX : null;
+    if (endX == null) return;
+
+    // 左侧边缘“禁滑区”：避免触发浏览器返回手势
+    const EDGE = 24; // px
+    if (touchX <= EDGE) {
+      touchX = touchY = dragX = dragY = null;
+      return;
+    }
+
+    const dx = endX - touchX;
+    touchX = touchY = dragX = dragY = null;
+    const TH = 40; // 触发阈值
+    if (dx > TH) prevLb();
+    else if (dx < -TH) nextLb();
+  }, { passive: true });
+
+  // 双击/双击（移动端双击）放大查看细节（1x->2x->3x->1x）
+  let lastClickAt = 0;
+  let lastClickX = 0;
+  let lastClickY = 0;
+  $('lbImg').addEventListener('click', (e) => {
+    if (!lbEl.classList.contains('open')) return;
+    const now = Date.now();
+    const dx = Math.abs((e.clientX || 0) - (lastClickX || 0));
+    const dy = Math.abs((e.clientY || 0) - (lastClickY || 0));
+
+    if (now - lastClickAt < 320 && dx < 24 && dy < 24) {
+      // double click
+      zoomAt(e.clientX, e.clientY);
+      lastClickAt = 0;
+      lastClickX = 0;
+      lastClickY = 0;
+    } else {
+      lastClickAt = now;
+      lastClickX = e.clientX || 0;
+      lastClickY = e.clientY || 0;
+    }
+  });
+
+  async function doUpload(files){
+    if (!files || !files.length) return;
+    const fd = new FormData();
+    for (const f of files) fd.append('files', f, f.name);
+
+    const dir = ($('dir').value || '').trim();
+    const r = await fetch('/api/upload?dir=' + encodeURIComponent(dir), {
+      method: 'POST',
+      body: fd
+    });
+    const data = await r.json().catch(() => ({}));
+    if (!r.ok) {
+      alert('上传失败：' + (data.error || r.status));
+      return;
+    }
+    await load(dir);
+  }
+
+  // settings
+  const settings = $('settings');
+  function openSettings(){ settings.classList.add('open'); }
+  function closeSettings(){ settings.classList.remove('open'); }
+
+  $('settingsBtn').addEventListener('click', openSettings);
+  $('settingsClose').addEventListener('click', (e) => { e.preventDefault(); closeSettings(); });
+  settings.addEventListener('click', (e) => { if (e.target === settings) closeSettings(); });
+  $('apply').addEventListener('click', () => { applyCols($('cols').value); closeSettings(); });
+
+  // bubble mode toggle
+  if ($('bubbleModeBtn')) {
+    setBubbleMode(bubbleMode);
+    $('bubbleModeBtn').addEventListener('click', (e) => {
+      e.preventDefault();
+      setBubbleMode(!bubbleMode);
+      const dir = ($('dir') && $('dir').value ? $('dir').value : '').trim();
+      load(dir);
+    });
+  }
+
+  // init cols
+  // 规则：电脑首次默认“自动平铺”（auto）；手机首次默认 3 列。
+  let savedCols = null;
+  try { savedCols = localStorage.getItem('gallery_cols'); } catch {}
+  if (savedCols) {
+    applyCols(savedCols);
+  } else {
+    const isMobile = (window.matchMedia && window.matchMedia('(max-width: 520px)').matches) || (window.innerWidth && window.innerWidth < 520);
+    applyCols(isMobile ? '3' : 'auto');
+  }
+
+  // autoplay 默认关闭（进入大图由用户手动点 ▶ 才开始）
+  updatePlayBtn();
+
+  // selection actions
+  $('toggleAll').addEventListener('click', (e) => {
+    e.preventDefault();
+    const total = document.querySelectorAll('.tile[data-name]').length;
+    if (selected.size >= total && total > 0) {
+      clearAll();
+      $('toggleAll').textContent = '全选';
+    } else {
+      selectAll();
+      $('toggleAll').textContent = '取消全选';
+    }
+  });
+
+  $('cancelSel').addEventListener('click', (e) => { e.preventDefault(); exitSelectMode(); $('toggleAll').textContent = '全选'; });
+
+  // settings: enter/exit delete mode
+  if ($('enterDelete')) {
+    $('enterDelete').addEventListener('click', (e) => {
+      e.preventDefault();
+      if (!selectMode) {
+        enterSelectMode();
+      } else {
+        exitSelectMode();
+      }
+    });
+  }
+
+  $('deleteSel').addEventListener('click', async (e) => {
+    e.preventDefault();
+    if (!selected.size) return;
+    const ok = confirm('确定删除选中的 ' + selected.size + ' 张图片？');
+    if (!ok) return;
+
+    const dir = ($('dir').value || '').trim();
+    const names = [...selected];
+    const r = await fetch('/api/delete', {
+      method: 'POST',
+      headers: { 'Content-Type': 'application/json' },
+      body: JSON.stringify({ dir, names })
+    });
+    const data = await r.json().catch(() => ({}));
+    if (!r.ok) {
+      alert('删除失败：' + (data.error || r.status));
+      return;
+    }
+    exitSelectMode();
+    await load(dir);
+  });
+
+  // upload (fab + settings)
+  $('uploadBtn').addEventListener('click', () => $('file').click());
+  $('uploadInSettings').addEventListener('click', () => $('file').click());
+
+  // autoplay: 持续播放直到用户关闭（不因操作而停止）
+  $('file').addEventListener('change', async () => {
+    const files = [...$('file').files];
+    $('file').value = '';
+    await doUpload(files);
+  });
+
+  $('go').addEventListener('click', () => load(($('dir').value || '').trim()));
+  $('dir').addEventListener('keydown', (e) => { if (e.key === 'Enter') load(($('dir').value || '').trim()); });
+
+  load('');
+</script>
+</body>
+</html>`);
+});
+
+app.listen(PORT, '0.0.0.0', () => {
+  console.log(`Image Gallery listening on :${PORT}`);
+  console.log(`Serving images from ${IMAGES_DIR}`);
+});
